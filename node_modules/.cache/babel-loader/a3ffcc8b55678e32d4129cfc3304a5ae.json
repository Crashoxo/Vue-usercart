{"remainingRequest":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\user\\Desktop\\demo\\Vue-cart\\src\\views\\Coupons.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\src\\views\\Coupons.vue","mtime":1636970374535},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\babel.config.js","mtime":1636350343535},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-cart\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvdXNlci9EZXNrdG9wL2RlbW8vVnVlLWNhcnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgQ291cG9uTW9kYWwgZnJvbSAiQC9jb21wb25lbnRzL0NvdXBvbk1vZGFsLnZ1ZSI7CmltcG9ydCBEZWxNb2RhbCBmcm9tICJAL2NvbXBvbmVudHMvRGVsTW9kYWwudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIENvdXBvbk1vZGFsOiBDb3Vwb25Nb2RhbCwKICAgIERlbE1vZGFsOiBEZWxNb2RhbAogIH0sCiAgcHJvcHM6IHsKICAgIGNvbmZpZzogT2JqZWN0CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY291cG9uczoge30sCiAgICAgIHRlbXBDb3Vwb246IHsKICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgaXNfZW5hYmxlZDogMCwKICAgICAgICBwZXJjZW50OiAxMDAsCiAgICAgICAgY29kZTogIiIKICAgICAgfSwKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgaXNOZXc6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgb3BlbkNvdXBvbk1vZGFsOiBmdW5jdGlvbiBvcGVuQ291cG9uTW9kYWwoaXNOZXcsIGl0ZW0pIHsKICAgICAgdGhpcy5pc05ldyA9IGlzTmV3OwoKICAgICAgaWYgKHRoaXMuaXNOZXcpIHsKICAgICAgICB0aGlzLnRlbXBDb3Vwb24gPSB7CiAgICAgICAgICAvLyDlop7liqAgZHVlX2RhdGUg5bGs5oCnCiAgICAgICAgICBkdWVfZGF0ZTogbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRlbXBDb3Vwb24gPSBfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKTsKICAgICAgfSAvLyAgIHJlZj0iY291cG9uTW9kYWwiIOW9iOeqlwoKCiAgICAgIHRoaXMuJHJlZnMuY291cG9uTW9kYWwuc2hvd01vZGFsKCk7CiAgICB9LAogICAgb3BlbkRlbENvdXBvbk1vZGFsOiBmdW5jdGlvbiBvcGVuRGVsQ291cG9uTW9kYWwoaXRlbSkgewogICAgICB0aGlzLnRlbXBDb3Vwb24gPSBfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKTsKICAgICAgdmFyIGRlbENvbXBvbmVudCA9IHRoaXMuJHJlZnMuZGVsTW9kYWw7CiAgICAgIGRlbENvbXBvbmVudC5zaG93TW9kYWwoKTsKICAgIH0sCiAgICBnZXRDb3Vwb25zOiBmdW5jdGlvbiBnZXRDb3Vwb25zKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICB2YXIgdXJsID0gIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQVBJLCAiYXBpLyIpLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1BBVEgsICIvYWRtaW4vY291cG9ucyIpOwogICAgICB0aGlzLiRodHRwLmdldCh1cmwsIHRoaXMudGVtcFByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMuY291cG9ucyA9IHJlc3BvbnNlLmRhdGEuY291cG9uczsKICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZUNvdXBvbjogZnVuY3Rpb24gdXBkYXRlQ291cG9uKHRlbXBDb3Vwb24pIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5pc05ldykgewogICAgICAgIC8vIOaWsOWingogICAgICAgIHZhciB1cmwgPSAiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9BUEksICJhcGkvIikuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfUEFUSCwgIi9hZG1pbi9jb3Vwb24iKTsKICAgICAgICB0aGlzLiRodHRwLnBvc3QodXJsLCB7CiAgICAgICAgICBkYXRhOiB0ZW1wQ291cG9uCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLCB0ZW1wQ291cG9uKTsKCiAgICAgICAgICBfdGhpczIuJGh0dHBNZXNzYWdlU3RhdGUocmVzcG9uc2UsICLmlrDlop7lhKrmg6DliLgiKTsKCiAgICAgICAgICBfdGhpczIuZ2V0Q291cG9ucygpOwoKICAgICAgICAgIF90aGlzMi4kcmVmcy5jb3Vwb25Nb2RhbC5oaWRlTW9kYWwoKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyAgIOe3qOi8rwogICAgICAgIHZhciBfdXJsID0gIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQVBJLCAiYXBpLyIpLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1BBVEgsICIvYWRtaW4vY291cG9uLyIpLmNvbmNhdCh0aGlzLnRlbXBDb3Vwb24uaWQpOwoKICAgICAgICB0aGlzLiRodHRwLnB1dChfdXJsLCB7CiAgICAgICAgICBkYXRhOiB0aGlzLnRlbXBDb3Vwb24KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwoKICAgICAgICAgIF90aGlzMi4kaHR0cE1lc3NhZ2VTdGF0ZShyZXNwb25zZSwgIuaWsOWinuWEquaDoOWIuCIpOwoKICAgICAgICAgIF90aGlzMi5nZXRDb3Vwb25zKCk7CgogICAgICAgICAgX3RoaXMyLiRyZWZzLmNvdXBvbk1vZGFsLmhpZGVNb2RhbCgpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsQ291cG9uOiBmdW5jdGlvbiBkZWxDb3Vwb24oKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIHVybCA9ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0FQSSwgImFwaS8iKS5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9QQVRILCAiL2FkbWluL2NvdXBvbi8iKS5jb25jYXQodGhpcy50ZW1wQ291cG9uLmlkKTsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLiRodHRwLmRlbGV0ZSh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UsIF90aGlzMy50ZW1wQ291cG9uKTsKCiAgICAgICAgX3RoaXMzLiRodHRwTWVzc2FnZVN0YXRlKHJlc3BvbnNlLCAi5Yiq6Zmk5YSq5oOg5Yi4Iik7CgogICAgICAgIHZhciBkZWxDb21wb25lbnQgPSBfdGhpczMuJHJlZnMuZGVsTW9kYWw7CiAgICAgICAgZGVsQ29tcG9uZW50LmhpZGVNb2RhbCgpOwoKICAgICAgICBfdGhpczMuZ2V0Q291cG9ucygpOwogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldENvdXBvbnMoKTsKICB9Cn07"},{"version":3,"sources":["C:\\Users\\user\\Desktop\\demo\\Vue-cart\\src\\views\\Coupons.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <!-- main.js 全域匯入 使用 -->\r\n    <Loading :active=\"isLoading\"></Loading>\r\n    <div class=\"text-end mt-4\">\r\n      <button class=\"btn btn-primary\" @click=\"openCouponModal(true)\">\r\n        建立新的優惠券\r\n      </button>\r\n    </div>\r\n    <table class=\"table mt-4\">\r\n      <thead>\r\n        <tr>\r\n          <th>名稱</th>\r\n          <th>折扣百分比</th>\r\n          <th>到期日</th>\r\n          <th>是否啟用</th>\r\n          <th>編輯</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"(item, key) in coupons\" :key=\"key\">\r\n          <td>{{ item.title }}</td>\r\n          <td>{{ item.percent }}%</td>\r\n          <!-- main.js $filters全域方法 -->\r\n          <td>{{ $filters.date(item.due_date) }}</td>\r\n          <td>\r\n            <span v-if=\"item.is_enabled === 1\" class=\"text-success\">啟用</span>\r\n            <span v-else class=\"text-muted\">未起用</span>\r\n          </td>\r\n          <td>\r\n            <div class=\"btn-group\">\r\n              <button\r\n                class=\"btn btn-outline-primary btn-sm\"\r\n                @click=\"openCouponModal(false, item)\"\r\n              >\r\n                編輯\r\n              </button>\r\n              <button\r\n                class=\"btn btn-outline-danger btn-sm\"\r\n                @click=\"openDelCouponModal(item)\"\r\n              >\r\n                刪除\r\n              </button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <!-- :coupon props -->\r\n    <!-- @update-coupon emit -->\r\n    <couponModal\r\n      :coupon=\"tempCoupon\"\r\n      ref=\"couponModal\"\r\n      @update-coupon=\"updateCoupon\"\r\n    />\r\n    <DelModal :item=\"tempCoupon\" ref=\"delModal\" @del-item=\"delCoupon\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CouponModal from \"@/components/CouponModal.vue\";\r\nimport DelModal from \"@/components/DelModal.vue\";\r\nexport default {\r\n  components: { CouponModal, DelModal },\r\n  props: {\r\n    config: Object,\r\n  },\r\n  data() {\r\n    return {\r\n      coupons: {},\r\n      tempCoupon: {\r\n        title: \"\",\r\n        is_enabled: 0,\r\n        percent: 100,\r\n        code: \"\",\r\n      },\r\n      isLoading: false,\r\n      isNew: false,\r\n    };\r\n  },\r\n  methods: {\r\n    openCouponModal(isNew, item) {\r\n      this.isNew = isNew;\r\n      if (this.isNew) {\r\n        this.tempCoupon = {\r\n          // 增加 due_date 屬性\r\n          due_date: new Date().getTime() / 1000,\r\n        };\r\n      } else {\r\n        this.tempCoupon = { ...item };\r\n      }\r\n      //   ref=\"couponModal\" 彈窗\r\n      this.$refs.couponModal.showModal();\r\n    },\r\n    openDelCouponModal(item) {\r\n      this.tempCoupon = { ...item };\r\n      const delComponent = this.$refs.delModal;\r\n      delComponent.showModal();\r\n    },\r\n    getCoupons() {\r\n      this.isLoading = true;\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons`;\r\n      this.$http.get(url, this.tempProduct).then((response) => {\r\n        this.coupons = response.data.coupons;\r\n        this.isLoading = false;\r\n        console.log(response);\r\n      });\r\n    },\r\n    updateCoupon(tempCoupon) {\r\n      if (this.isNew) {\r\n        // 新增\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`;\r\n        this.$http.post(url, { data: tempCoupon }).then((response) => {\r\n          console.log(response, tempCoupon);\r\n          this.$httpMessageState(response, \"新增優惠券\");\r\n          this.getCoupons();\r\n          this.$refs.couponModal.hideModal();\r\n        });\r\n      } else {\r\n        //   編輯\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\r\n        this.$http.put(url, { data: this.tempCoupon }).then((response) => {\r\n          console.log(response);\r\n          this.$httpMessageState(response, \"新增優惠券\");\r\n          this.getCoupons();\r\n          this.$refs.couponModal.hideModal();\r\n        });\r\n      }\r\n    },\r\n    delCoupon() {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\r\n      this.isLoading = true;\r\n      this.$http.delete(url).then((response) => {\r\n        console.log(response, this.tempCoupon);\r\n        this.$httpMessageState(response, \"刪除優惠券\");\r\n        const delComponent = this.$refs.delModal;\r\n        delComponent.hideModal();\r\n        this.getCoupons();\r\n      });\r\n    },\r\n  },\r\n  created() {\r\n    this.getCoupons();\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":""}]}