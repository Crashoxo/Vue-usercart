{"remainingRequest":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\src\\views\\Orders.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\src\\views\\Orders.vue","mtime":1637712468094},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\babel.config.js","mtime":1636350343535},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvdXNlci9EZXNrdG9wL2RlbW8vVnVlLXVzZXJjYXJ0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IERlbE1vZGFsIGZyb20gIkAvY29tcG9uZW50cy9EZWxNb2RhbC52dWUiOwppbXBvcnQgT3JkZXJNb2RhbCBmcm9tICJAL2NvbXBvbmVudHMvb3JkZXJNb2RhbC52dWUiOwppbXBvcnQgUGFnaW5hdGlvbiBmcm9tICJAL2NvbXBvbmVudHMvUGFnaW5hdGlvbi52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9yZGVyczoge30sCiAgICAgIGlzTmV3OiBmYWxzZSwKICAgICAgcGFnaW5hdGlvbjoge30sCiAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgIHRlbXBPcmRlcjoge30sCiAgICAgIGN1cnJlbnRQYWdlOiAxCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgUGFnaW5hdGlvbjogUGFnaW5hdGlvbiwKICAgIERlbE1vZGFsOiBEZWxNb2RhbCwKICAgIE9yZGVyTW9kYWw6IE9yZGVyTW9kYWwKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldE9yZGVyczogZnVuY3Rpb24gZ2V0T3JkZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGN1cnJlbnRQYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gY3VycmVudFBhZ2U7CiAgICAgIHZhciB1cmwgPSAiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9BUEksICJhcGkvIikuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfUEFUSCwgIi9hZG1pbi9vcmRlcnM/cGFnZT0iKS5jb25jYXQoY3VycmVudFBhZ2UpOwogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7CiAgICAgIHRoaXMuJGh0dHAuZ2V0KHVybCwgdGhpcy50ZW1wUHJvZHVjdCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy5vcmRlcnMgPSByZXNwb25zZS5kYXRhLm9yZGVyczsKICAgICAgICBfdGhpcy5wYWdpbmF0aW9uID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uOwogICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgfSk7CiAgICB9LAogICAgb3Blbk1vZGFsOiBmdW5jdGlvbiBvcGVuTW9kYWwoaXNOZXcsIGl0ZW0pIHsKICAgICAgdGhpcy50ZW1wT3JkZXIgPSBfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKTsKICAgICAgdGhpcy5pc05ldyA9IGZhbHNlOwogICAgICB2YXIgb3JkZXJDb21wb25lbnQgPSB0aGlzLiRyZWZzLm9yZGVyTW9kYWw7CiAgICAgIG9yZGVyQ29tcG9uZW50LnNob3dNb2RhbCgpOwogICAgfSwKICAgIG9wZW5EZWxPcmRlck1vZGFsOiBmdW5jdGlvbiBvcGVuRGVsT3JkZXJNb2RhbChpdGVtKSB7CiAgICAgIHRoaXMudGVtcE9yZGVyID0gX29iamVjdFNwcmVhZCh7fSwgaXRlbSk7CiAgICAgIHZhciBkZWxDb21wb25lbnQgPSB0aGlzLiRyZWZzLmRlbE1vZGFsOwogICAgICBkZWxDb21wb25lbnQuc2hvd01vZGFsKCk7CiAgICB9LAogICAgdXBkYXRlUGFpZDogZnVuY3Rpb24gdXBkYXRlUGFpZChpdGVtKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2hleHNjaG9vbC92dWUzLWNvdXJzZS1hcGktd2lraS93aWtpLyVFNyVBRSVBMSVFNyU5MCU4NiVFNiU4RSVBNyVFNSU4OCVCNiVFNSU4RiVCMC0lNUIlRTklOUMlODAlRTklQTklOTclRTglQUQlODklNUQjJUU0JUJGJUFFJUU2JTk0JUI5JUU4JUE4JTgyJUU1JTk2JUFFCiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgdmFyIGFwaSA9ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0FQSSwgImFwaS8iKS5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9QQVRILCAiL2FkbWluL29yZGVyLyIpLmNvbmNhdChpdGVtLmlkKTsKICAgICAgdmFyIHBhaWQgPSB7CiAgICAgICAgaXNfcGFpZDogaXRlbS5pc19wYWlkCiAgICAgIH07CiAgICAgIHRoaXMuJGh0dHAucHV0KGFwaSwgewogICAgICAgIGRhdGE6IHBhaWQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuaXNMb2FkaW5nID0gZmFsc2U7CgogICAgICAgIF90aGlzMi5nZXRPcmRlcnMoX3RoaXMyLmN1cnJlbnRQYWdlKTsKCiAgICAgICAgX3RoaXMyLiRodHRwTWVzc2FnZVN0YXRlKHJlc3BvbnNlLCAi5pu05paw5LuY5qy+54uA5oWLIik7CiAgICAgIH0pOwogICAgfSwKICAgIGRlbE9yZGVyOiBmdW5jdGlvbiBkZWxPcmRlcigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgdXJsID0gIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQVBJLCAiYXBpLyIpLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1BBVEgsICIvYWRtaW4vb3JkZXIvIikuY29uY2F0KHRoaXMudGVtcE9yZGVyLmlkKTsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLiRodHRwLmRlbGV0ZSh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIHZhciBkZWxDb21wb25lbnQgPSBfdGhpczMuJHJlZnMuZGVsTW9kYWw7CiAgICAgICAgZGVsQ29tcG9uZW50LmhpZGVNb2RhbCgpOwoKICAgICAgICBfdGhpczMuZ2V0T3JkZXJzKF90aGlzMy5jdXJyZW50UGFnZSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0T3JkZXJzKCk7CiAgICBjb25zb2xlLmxvZyhwcm9jZXNzLmVudi5WVUVfQVBQX0FQSSk7CiAgfQp9Ow=="},{"version":3,"sources":["C:\\Users\\user\\Desktop\\demo\\Vue-usercart\\src\\views\\Orders.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <Loading :active=\"isLoading\"></Loading>\r\n  <table class=\"table mt-4 \">\r\n    <thead>\r\n      <tr>\r\n        <th>購買時間</th>\r\n        <th>Email</th>\r\n        <th>購買款項</th>\r\n        <th>應付金額</th>\r\n        <th>是否付款</th>\r\n        <th>編輯</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <template v-for=\"(item, key) in orders\" :key=\"key\">\r\n        <tr v-if=\"orders.length\" :class=\"{ 'text-secondary': !item.is_paid }\">\r\n          <td>{{ $filters.date(item.create_at) }}</td>\r\n          <td><span v-text=\"item.user.email\" v-if=\"item.user\"></span></td>\r\n          <td>\r\n            <ul class=\"list-unstyled\">\r\n              <li v-for=\"(product, i) in item.products\" :key=\"i\">\r\n                {{ product.product.title }} 數量：{{ product.qty }}\r\n                {{ product.product.unit }}\r\n              </li>\r\n            </ul>\r\n          </td>\r\n          <td class=\"text-right\">{{ item.total }}</td>\r\n          <td>\r\n            <div class=\"form-check form-switch\">\r\n              <input\r\n                class=\"form-check-input\"\r\n                type=\"checkbox\"\r\n                :id=\"`paidSwitch${item.id}`\"\r\n                v-model=\"item.is_paid\"\r\n                @change=\"updatePaid(item)\"\r\n              />\r\n              <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\r\n                <span v-if=\"item.is_paid\">已付款</span>\r\n                <span v-else>未付款</span>\r\n              </label>\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <div class=\"btn-group\">\r\n              <button\r\n                class=\"btn btn-outline-light btn-sm\"\r\n                @click=\"openModal(false, item)\"\r\n              >\r\n                View\r\n              </button>\r\n              <button\r\n                class=\"btn btn-outline-danger btn-sm\"\r\n                @click=\"openDelOrderModal(item)\"\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n      </template>\r\n    </tbody>\r\n  </table>\r\n  <OrderModal\r\n    :order=\"tempOrder\"\r\n    ref=\"orderModal\"\r\n    @update-paid=\"updatePaid\"\r\n  ></OrderModal>\r\n  <DelModal :item=\"tempOrder\" ref=\"delModal\" @del-item=\"delOrder\"></DelModal>\r\n  <!-- 分頁 -->\r\n  <Pagination :pages=\"pagination\" @emit-pages=\"getOrders\"></Pagination>\r\n</template>\r\n\r\n<script>\r\nimport DelModal from \"@/components/DelModal.vue\";\r\nimport OrderModal from \"@/components/orderModal.vue\";\r\nimport Pagination from \"@/components/Pagination.vue\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      orders: {},\r\n      isNew: false,\r\n      pagination: {},\r\n      isLoading: false,\r\n      tempOrder: {},\r\n      currentPage: 1,\r\n    };\r\n  },\r\n  components: {\r\n    Pagination,\r\n    DelModal,\r\n    OrderModal,\r\n  },\r\n  methods: {\r\n    getOrders(currentPage = 1) {\r\n      this.currentPage = currentPage;\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\r\n      this.isLoading = true;\r\n      this.$http.get(url, this.tempProduct).then((response) => {\r\n        this.orders = response.data.orders;\r\n        this.pagination = response.data.pagination;\r\n        this.isLoading = false;\r\n        console.log(response);\r\n      });\r\n    },\r\n    openModal(isNew, item) {\r\n      this.tempOrder = { ...item };\r\n      this.isNew = false;\r\n      const orderComponent = this.$refs.orderModal;\r\n      orderComponent.showModal();\r\n    },\r\n    openDelOrderModal(item) {\r\n      this.tempOrder = { ...item };\r\n      const delComponent = this.$refs.delModal;\r\n      delComponent.showModal();\r\n    },\r\n    updatePaid(item) {\r\n      // https://github.com/hexschool/vue3-course-api-wiki/wiki/%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0-%5B%E9%9C%80%E9%A9%97%E8%AD%89%5D#%E4%BF%AE%E6%94%B9%E8%A8%82%E5%96%AE\r\n      this.isLoading = true;\r\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\r\n      const paid = {\r\n        is_paid: item.is_paid,\r\n      };\r\n      this.$http.put(api, { data: paid }).then((response) => {\r\n        this.isLoading = false;\r\n        this.getOrders(this.currentPage);\r\n        this.$httpMessageState(response, \"更新付款狀態\");\r\n      });\r\n    },\r\n    delOrder() {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\r\n      this.isLoading = true;\r\n      this.$http.delete(url).then((response) => {\r\n        console.log(response);\r\n        const delComponent = this.$refs.delModal;\r\n        delComponent.hideModal();\r\n        this.getOrders(this.currentPage);\r\n      });\r\n    },\r\n  },\r\n  created() {\r\n    this.getOrders();\r\n    console.log(process.env.VUE_APP_API);\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":""}]}